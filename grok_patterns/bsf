# Barracuda Spam Firewall Grok Patterns
BSF_PROCESS inbound/pass1|inbound/pass2|scan|outbound/smtp
BSF_SERVICE RECV|SCAN|SEND
BSF_SENDER %{NOTSPACE}|-
BSF_RECIPIENT %{NOTSPACE}|-
BSF_ENCRYPTION ENC|-
BSF_INT %{INT}|-
BSF_NUMBER %{NUMBER}|-

# Common Particles
BSF_SCAN %{BSF_PROCESS:process}: %{HOSTNAME:client_name}\[%{IP:client_ip}\] %{NOTSPACE:message_id} %{BSF_NUMBER:unix_start_time} %{BSF_NUMBER:unix_end_time} %{BSF_SERVICE:service} %{BSF_ENCRYPTION:encryption} %{BSF_SENDER:sender} %{BSF_RECIPIENT:recipient} %{BSF_NUMBER:score} %{BSF_INT:action_id} %{BSF_INT:reason_id} %{GREEDYDATA:reason_extra} SZ:%{BSF_INT:size} SUBJ:%{GREEDYDATA:subject}
BSF_SEND %{BSF_PROCESS:process}: %{IP:client_ip} %{NOTSPACE:message_id} %{BSF_NUMBER:unix_start_time} %{BSF_NUMBER:unix_end_time} %{BSF_SERVICE:service} %{BSF_ENCRYPTION:encryption} %{BSF_INT:action_id} %{NOTSPACE:queue_id} %{GREEDYDATA:delivery_detail} #to#%{GREEDYDATA:destination}
BSF_RECV_SCAN %{BSF_PROCESS:process}: %{HOSTNAME:client_name}\[%{IP:client_ip}\] %{NOTSPACE:message_id} %{BSF_NUMBER:unix_start_time} %{BSF_NUMBER:unix_end_time} %{BSF_SERVICE:service} %{BSF_ENCRYPTION:encryption} %{BSF_SENDER:sender} %{BSF_RECIPIENT:recipient} %{BSF_NUMBER:score} %{BSF_INT:action_id} %{BSF_INT:reason_id} %{GREEDYDATA:reason_extra} SZ:%{BSF_INT:size} SUBJ:%{GREEDYDATA:subject}
BSF_RECV %{BSF_PROCESS:process}: %{HOSTNAME:client_name}\[%{IP:client_ip}\] %{NOTSPACE:message_id} %{BSF_NUMBER:unix_start_time} %{BSF_NUMBER:unix_end_time} %{BSF_SERVICE:service} %{BSF_SENDER:sender} %{BSF_RECIPIENT:recipient} %{BSF_INT:action_id} %{BSF_INT:reason_id} %{GREEDYDATA:reason_extra}
